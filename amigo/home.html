<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMIGO - Home</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif'],
                        'pacifico': ['Pacifico', 'cursive'],
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 font-sans transition-colors duration-300">
    <div id="app" class="flex h-screen overflow-hidden">
        <!-- Left Sidebar -->
        <aside class="w-20 lg:w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex-col justify-between hidden md:flex">
            <div>
                <div class="h-16 flex items-center justify-center lg:justify-start lg:pl-6">
                    <h1 class="text-3xl font-pacifico text-indigo-600 dark:text-indigo-400">A</h1>
                    <h1 class="text-3xl font-pacifico text-indigo-600 dark:text-indigo-400 hidden lg:block ml-2">AMIGO</h1>
                </div>
                <nav class="mt-8">
                    <ul>
                        <li><a href="#" class="flex items-center justify-center lg:justify-start py-3 px-6 text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 border-l-4 border-indigo-500 font-semibold">
                            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg>
                            <span class="ml-4 hidden lg:block">Home</span>
                        </a></li>
                        <li><a href="#" class="flex items-center justify-center lg:justify-start py-3 px-6 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-800 dark:hover:text-white">
                            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path></svg>
                            <span class="ml-4 hidden lg:block">Explore</span>
                        </a></li>
                        <li><a href="#" class="flex items-center justify-center lg:justify-start py-3 px-6 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-800 dark:hover:text-white">
                            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
                            <span class="ml-4 hidden lg:block">Messages</span>
                        </a></li>
                        <li><a href="profile.html" class="flex items-center justify-center lg:justify-start py-3 px-6 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-800 dark:hover:text-white">
                            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                            <span class="ml-4 hidden lg:block">Profile</span>
                        </a></li>
                    </ul>
                </nav>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <!-- Top Navigation -->
            <header class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 h-16 flex items-center justify-between px-4 md:px-6">
                <div class="md:hidden">
                    <h1 class="text-xl font-pacifico text-indigo-600 dark:text-indigo-400">AMIGO</h1>
                </div>
                <div class="hidden md:block">
                    <h2 class="text-xl font-bold">Home</h2>
                </div>
                <div class="flex items-center space-x-4">
                     <button id="darkModeToggle" class="p-2 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-gray-800 focus:ring-indigo-500">
                        <svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                        <svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                    </button>
                    <button class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700">
                        <svg class="h-6 w-6 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>
                    </button>
                    <a href="profile.html">
                        <img class="h-9 w-9 rounded-full object-cover" src="https://i.pravatar.cc/150?u=a042581f4e29026704d" alt="profile photo">
                    </a>
                    <a href="/friends.html" class="hidden sm:block px-4 py-2 text-sm font-semibold bg-indigo-600  text-white rounded-lg hover:bg-green-700">
  Find Friends
</a>
                    <a href="/index.html" class="hidden sm:block px-4 py-2 text-sm font-semibold bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">Logout</a>
                </div>
            </header>

            <!-- Main feed and right sidebar wrapper -->
            <div class="flex-1 flex overflow-hidden">
                <!-- Main Feed -->
                <section class="flex-1 overflow-y-auto p-4 md:p-6 lg:p-8 space-y-6 pb-20 md:pb-8">
                    <!-- Create Post -->
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow">
                        <div class="flex space-x-4">
                            <img class="h-12 w-12 rounded-full object-cover" src="https://i.pravatar.cc/150?u=a042581f4e29026704d" alt="profile photo">
                            <textarea class="flex-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="What's on your mind?"></textarea>
                          <div class="relative inline-block mt-3">
  <label for="imageInput" class="cursor-pointer inline-flex items-center gap-2 bg-indigo-600 text-white px-3 py-1 rounded-full hover:bg-indigo-700 transition">
    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path d="M3 8l2-2h4l2-2h4l2 2h4l2 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V8z" />
      <circle cx="12" cy="13" r="4" />
    </svg>
    <span>Photo</span>
  </label>
  <input type="file" id="imageInput" accept="image/*" capture="environment" class="hidden" />

</div>


                        </div>
                        <div class="flex justify-end mt-4">
                            <button class="bg-indigo-600 text-white font-semibold px-6 py-2 rounded-lg hover:bg-indigo-700">Post</button>
                        </div>
                    </div>

                 <div id="postFeed" class="space-y-6"></div>
                <div class="posts-feed space-y-4"></div>


                </section>


<!-- Mobile Bottom Navigation -->
<!-- Mobile Bottom Navigation -->
<nav class="md:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 p-2 flex justify-around">
    <a href="home.html" class="p-2 rounded-md text-indigo-500 bg-gray-100 dark:bg-gray-700">
        <!-- Home -->
        <svg class="h-7 w-7" fill="currentColor" viewBox="0 0 20 20">
            <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path>
        </svg>
    </a>

    <a href="posts.html" class="p-2 rounded-md text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-indigo-500">
        <!-- Posts -->
        <svg class="h-7 w-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path>
        </svg>
    </a>

    <a href="notifications.html" class="p-2 rounded-md text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-indigo-500">
        <!-- Notifications -->
        <svg class="h-7 w-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
        </svg>
    </a>

    <a href="friends.html" class="p-2 rounded-md text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-indigo-500">
        <!-- 👤 This was Profile, now goes to Friends -->
        <svg class="h-7 w-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
    </a>
</nav>


 <script type="module">
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import {
  getFirestore,
  doc,
  getDoc,
  updateDoc,
  collection,
  addDoc,
  serverTimestamp,
  onSnapshot,
  query,
  orderBy
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyCh4rG-JBamK1YVjZIKy49BL7sO_cUzuog",
  authDomain: "idr-488b2.firebaseapp.com",
  projectId: "idr-488b2",
  storageBucket: "idr-488b2.appspot.com",
  messagingSenderId: "220979507758",
  appId: "1:220979507758:web:d2860ac10cfb58ad5725bf"
};

// Init
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// DOM refs
const logoutBtn = document.querySelector('a[href="/index.html"]');
const postButton = document.querySelector("button.bg-indigo-600");
const postTextarea = document.querySelector("textarea");
const postContainer = document.querySelector(".posts-feed");
const darkModeToggle = document.getElementById('darkModeToggle');
const moonIcon = document.getElementById('moonIcon');
const sunIcon = document.getElementById('sunIcon');

// 🔐 Auth
onAuthStateChanged(auth, async (user) => {
  if (!user) {
    window.location.href = "/index.html";
  } else {
    const userSnap = await getDoc(doc(db, "users", user.uid));
    const userData = userSnap.data();

    if (postTextarea) {
      postTextarea.placeholder = `What's on your mind, ${userData.name || "friend"}?`;
    }

    document.querySelectorAll('img[alt="profile photo"]').forEach(img => {
      img.src = userData.profilePic || `https://i.pravatar.cc/300?u=${user.uid}`;
    });
  }
});

// 🚪 Logout
logoutBtn?.addEventListener("click", async (e) => {
  e.preventDefault();
  const user = auth.currentUser;
  if (user) {
    await updateDoc(doc(db, "users", user.uid), { isOnline: false });
    await signOut(auth);
    window.location.href = "/index.html";
  }
});

// 🌙 Dark Mode
function applyTheme(theme) {
  if (theme === 'dark') {
    document.documentElement.classList.add('dark');
    moonIcon?.classList.add('hidden');
    sunIcon?.classList.remove('hidden');
  } else {
    document.documentElement.classList.remove('dark');
    moonIcon?.classList.remove('hidden');
    sunIcon?.classList.add('hidden');
  }
}
const savedTheme = localStorage.getItem('theme');
applyTheme(savedTheme || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'));

darkModeToggle?.addEventListener("click", () => {
  const newTheme = document.documentElement.classList.contains("dark") ? "light" : "dark";
  localStorage.setItem("theme", newTheme);
  applyTheme(newTheme);
});

// 📝 Create Post
postButton?.addEventListener("click", async () => {
  const text = postTextarea.value.trim();
  if (!text) return;
  const user = auth.currentUser;
  const userSnap = await getDoc(doc(db, "users", user.uid));
  const userData = userSnap.data();

  await addDoc(collection(db, "posts"), {
    text,
    userId: user.uid,
    name: userData.name || "Unknown",
    profilePic: userData.profilePic || `https://i.pravatar.cc/300?u=${user.uid}`,
    timestamp: serverTimestamp(),
    likes: []
  });
  postTextarea.value = "";
});

// 🔄 Load & Display Posts
const postsQuery = collection(db, "posts");

onSnapshot(postsQuery, (snapshot) => {
  const postsArray = [];

  snapshot.forEach((docSnap) => {
    postsArray.push({ id: docSnap.id, data: docSnap.data() });
  });

  // 🔀 Shuffle posts randomly
  for (let i = postsArray.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [postsArray[i], postsArray[j]] = [postsArray[j], postsArray[i]];
  }

  postContainer.innerHTML = "";

  postsArray.forEach(({ id: postId, data: post }) => {
    const div = document.createElement("div");
    div.className = "bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-4";

    div.innerHTML = `
      <div class="flex items-center gap-3 mb-2">
        <img src="${post.profilePic}" class="w-10 h-10 rounded-full" />
        <div>
          <p class="font-semibold">${post.name}</p>
          <p class="text-sm text-gray-500 dark:text-gray-400">${new Date(post.timestamp?.toDate()).toLocaleString()}</p>
        </div>
      </div>
      <p class="mt-2 text-gray-700 dark:text-gray-300">${post.text}</p>
      ${post.imageUrl ? `<img src="${post.imageUrl}" class="mt-3 rounded-lg w-full max-h-72 object-cover" />` : ""}
      <div class="mt-3 flex items-center gap-4">
        <button class="like-btn" data-id="${postId}">❤️ <span class="like-count">${post.likes?.length || 0}</span></button>
        <button class="comment-btn" data-id="${postId}">💬 Comments</button>
      </div>
      <div class="comments-section mt-3 hidden" data-id="${postId}">
        <div class="comments-list space-y-2"></div>
        <input type="text" placeholder="Add a comment..." class="comment-input mt-2 p-2 border rounded w-full" />
        <button class="submit-comment mt-1 bg-blue-500 text-white px-3 py-1 rounded">Post</button>
      </div>
    `;

    // ❤️ Like
    div.querySelector(".like-btn").addEventListener("click", async () => {
      const postRef = doc(db, "posts", postId);
      const postSnap = await getDoc(postRef);
      const postData = postSnap.data();
      const likes = postData.likes || [];
      const userId = auth.currentUser.uid;

      if (likes.includes(userId)) {
        await updateDoc(postRef, { likes: likes.filter(id => id !== userId) });
      } else {
        await updateDoc(postRef, { likes: [...likes, userId] });

// 🛎️ Notification for like
if (postData.userId !== userId) {
  await addDoc(collection(db, "users", postData.userId, "notifications"), {
    type: "like",
    fromUserId: userId,
    postId,
    timestamp: serverTimestamp(),
    read: false
  });
}
}
});

// 💬 Toggle comment box
div.querySelector(".comment-btn").addEventListener("click", () => {
  const section = div.querySelector(`.comments-section[data-id="${postId}"]`);
  section.classList.toggle("hidden");
});

// ➕ Submit Comment
div.querySelector(".submit-comment").addEventListener("click", async () => {
  const section = div.querySelector(`.comments-section[data-id="${postId}"]`);
  const input = section.querySelector(".comment-input");
  const text = input.value.trim();
  if (!text) return;

  const user = auth.currentUser;
  const userSnap = await getDoc(doc(db, "users", user.uid));
  const userData = userSnap.data();

  await addDoc(collection(db, "posts", postId, "comments"), {
    text,
    name: userData.name,
    profilePic: userData.profilePic || "",
    userId: user.uid,
    timestamp: serverTimestamp()
  });

  input.value = "";

  // 🛎️ Notification for comment
  if (post.userId !== user.uid) {
    await addDoc(collection(db, "users", post.userId, "notifications"), {
      type: "comment",
      fromUserId: user.uid,
      postId,
      timestamp: serverTimestamp(),
      read: false
    });
  }
});

// 🔄 Real-time Comments
const commentsList = div.querySelector(".comments-list");
const commentsRef = collection(db, "posts", postId, "comments");
const commentsQuery = query(commentsRef, orderBy("timestamp", "asc"));

onSnapshot(commentsQuery, (commentsSnap) => {
  commentsList.innerHTML = "";
  commentsSnap.forEach(commentDoc => {
    const comment = commentDoc.data();
    const commentId = commentDoc.id;

    commentsList.innerHTML += `
      <div class="bg-gray-100 dark:bg-gray-700 p-2 rounded">
        <div class="flex items-center gap-2">
          <img src="${comment.profilePic}" class="w-6 h-6 rounded-full" />
          <p class="text-sm font-semibold">${comment.name}</p>
        </div>
        <p class="text-sm text-gray-800 dark:text-gray-200 mt-1">${comment.text}</p>

        <button class="reply-btn text-xs text-indigo-600 mt-1" data-id="${commentId}">Reply</button>
        <div class="reply-box mt-2 hidden" data-id="${commentId}">
          <input type="text" placeholder="Reply..." class="reply-input p-1 w-full rounded border text-sm" />
          <button class="send-reply mt-1 bg-indigo-500 text-white px-2 py-1 text-xs rounded">Send</button>
        </div>

        <div class="replies-list space-y-2 mt-2" data-id="${commentId}"></div>
      </div>
    `;

    setTimeout(() => {
      const replyButtons = commentsList.querySelectorAll(".reply-btn");
      replyButtons.forEach(button => {
        button.addEventListener("click", () => {
          const cid = button.getAttribute("data-id");
          const box = commentsList.querySelector(`.reply-box[data-id="${cid}"]`);
          box.classList.toggle("hidden");
        });
      });

      const sendReplyBtns = commentsList.querySelectorAll(".send-reply");
      sendReplyBtns.forEach(btn => {
        btn.addEventListener("click", async () => {
          const cid = btn.parentElement.getAttribute("data-id");
          const input = commentsList.querySelector(`.reply-box[data-id="${cid}"] input`);
          const text = input.value.trim();
          if (!text) return;

          const user = auth.currentUser;
          const userSnap = await getDoc(doc(db, "users", user.uid));
          const userData = userSnap.data();

          const replyRef = collection(db, "posts", postId, "comments", cid, "replies");
          await addDoc(replyRef, {
            text,
            name: userData.name,
            profilePic: userData.profilePic || "",
            userId: user.uid,
            timestamp: serverTimestamp()
          });

          input.value = "";

          // 🛎️ Notification for reply
          const commentRef = doc(db, "posts", postId, "comments", cid);
          const commentSnap = await getDoc(commentRef);
          const commentOwnerId = commentSnap.data()?.userId;

          if (commentOwnerId && commentOwnerId !== user.uid) {
            await addDoc(collection(db, "users", commentOwnerId, "notifications"), {
              type: "reply",
              fromUserId: user.uid,
              postId,
              commentId: cid,
              text,
              timestamp: serverTimestamp(),
              read: false
            });
          }
        });
      });
    }, 0);

    // 🔁 Real-time Replies
    const repliesList = div.querySelector(`.replies-list[data-id="${commentId}"]`);
    const repliesRef = collection(db, "posts", postId, "comments", commentId, "replies");
    const repliesQuery = query(repliesRef, orderBy("timestamp", "asc"));

    onSnapshot(repliesQuery, (replySnap) => {
      repliesList.innerHTML = "";
      replySnap.forEach(replyDoc => {
        const reply = replyDoc.data();
        repliesList.innerHTML += `
          <div class="bg-gray-200 dark:bg-gray-600 p-2 rounded ml-6">
            <div class="flex items-center gap-2">
              <img src="${reply.profilePic}" class="w-5 h-5 rounded-full" />
              <p class="text-sm font-semibold">${reply.name}</p>
            </div>
            <p class="text-sm text-gray-800 dark:text-gray-200 mt-1">${reply.text}</p>
          </div>
        `;
      });
    });
  });
});
    postContainer.appendChild(div);
  });
});

const storage = getStorage(app);

postButton?.addEventListener("click", async () => {
  const text = postTextarea.value.trim();
  const imageInput = document.getElementById("imageInput");
  const imageFile = imageInput?.files?.[0]; // ✅ safer

  if (!text && !imageFile) return; // if both empty, don’t post

  const user = auth.currentUser;
  if (!user) return;

  const userRef = doc(db, "users", user.uid);
  const userSnap = await getDoc(userRef);
  const userData = userSnap.data();

  let imageUrl = "";

  if (imageFile) {
    const imageRef = ref(storage, `posts/${user.uid}/${Date.now()}-${imageFile.name}`);
    await uploadBytes(imageRef, imageFile);
    imageUrl = await getDownloadURL(imageRef);
  }

  await addDoc(collection(db, "posts"), {
    text,
    imageUrl,
    userId: user.uid,
    name: userData.name || "Unknown",
    profilePic: userData.profilePic || "",
    timestamp: serverTimestamp(),
    likes: []
  });

  postTextarea.value = "";
  if (imageInput) imageInput.value = "";
});
// ✅ This runs on every protected page
onAuthStateChanged(auth, (user) => {
  if (!user) {
    // ❌ Not logged in? Send to index (login) page
    window.location.href = "/index.html";
  }
});
</script>
<script>
  if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/sw.js")
    .then(() => console.log("✅ Service Worker Registered"))
    .catch((err) => console.log("❌ Service Worker Failed", err));
}

</script>
<script type="module">
  import { protectPage } from "./authCheck.js";

  protectPage(); // 🔒 only logged in users allowed
</script>

<script type="module">
  import { logout } from "./authCheck.js";

  document.getElementById("logoutBtn").addEventListener("click", logout);
</script>

</body>
</html>